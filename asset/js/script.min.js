const url="https://api.themoviedb.org/3/movie/",img_url="http://image.tmdb.org/t/p/w185/",back_url="http://image.tmdb.org/t/p/original/",notFound="https://www.book.mn/uploads/book_author/nopic.jpg";let page=0;const btn_indicator=document.getElementById("btn-indicator"),slide_movie=document.getElementById("slide-movie");let condition="";const main_body=document.getElementById("main-body"),load=document.getElementById("loader");let now_playing=[];function render_slide(e){for(let t=0;t<5;t++)0==t&&(condition="active"),btn_indicator.innerHTML+='<button type="button" style="background-color:black;" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="'+t+'" class="active" aria-current="true" aria-label="Slide 1"></button>',slide_movie.innerHTML+='<div class="carousel-item '+condition+'" ><img src="'+back_url+e[t].backdrop_path+'" class="d-block w-100" alt="..." loading="lazy"><div class="carousel-caption d-none d-md-block" style="background-color:rgba(255, 255, 255, 0.5);color:black; padding:12px"><h5>'+e[t].original_title+"</h5><p>"+e[t].overview+'</p><button class="btn btn-outline-dark" onclick="gotoDetailPage(\''+e[t].id+'\')" style="margin-bottom: 12px;">See More</button>',condition=""}async function getMovie(e){const t=await fetch(url+"popular?api_key="+api_key+"&language="+lang+"&page="+e.toString());return await t.json()}async function loadMore(){if(window.innerHeight+window.scrollY>=document.body.offsetHeight){page+=1,renderData(await getMovie(page))}}function renderData(e){let t="";e.results.forEach(e=>{t=null===e.poster_path?notFound:img_url+e.poster_path,main_body.innerHTML+="<div class='card-main card col-md-4 col-sm-12'><div class='tag-rate'><i class='fa fa-star' aria-hidden='true'></i> "+e.vote_average+"</div><img src='"+t+"' class='card-img-top img-fluid' alt='...' loading='lazy'><div class='card-body' id='"+e.id+"'><h5 class='card-title'>"+e.original_title+"</h5><p class='card-text'>"+e.release_date.slice(0,4)+"<br></p></div><div class='card-footer text-muted'><a href='/detail.html?movie="+encodeURI(e.id)+"'><button class='btn btn-primary' style='margin-bottom:12px;'>See More</button></a></div>",e.genre_ids.forEach(t=>{let a=genre_data.findIndex(e=>e.id===t),o=genre_data[a].name;document.getElementById(e.id).innerHTML+='<a href="/genre.html?genre='+encodeURI(o)+'"><button type="button" class="btn btn-danger btn-sm" style="margin:4px">'+o+"</button></a>"})})}function gotoSearchPage(){let e=document.getElementById("movSearch").value.replace(/</g,"&lt;").replace(/>/g,"&gt;"),t="/search.html?search="+encodeURI(e);document.location.href=t}fetch(url+"now_playing?api_key="+api_key+"&language="+lang+"&page=1").then(e=>e.json()).then(e=>{render_slide(now_playing=e.results)}).catch(e=>console.error(e)),loadMore(),document.addEventListener("scroll",loadMore);